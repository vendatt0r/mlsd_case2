# Кейс №2
*Бизнес-цель*:

Создать автоматизированную систему идентификации личности по фотографии для замены традиционных методов (пропусков, паролей, отпечатков пальцев) в сценариях контроля доступа на промышленном предприятии.

*Описание текущего процесса*:

Сейчас процесс проверки личности на проходной полностью ручной - на КПП дежурный сканирует пластиковый пропуск и "на глаз" проверяет сходство человека с фотографией в его профиле. Руководство предприятия хочет автоматизировать этот процесс, создав систему автоматического распознавания фото человека на проходной по базе сотрудников.

Количество сотрудников на предприятии ~5000. Количество проходных - 10.

## Состав команды
 - Русинов Василий
 - Чебан Илья 

## Цели и предпосылки
### Зачем идем в разработку продукта?
- Снижение затрат на ручной труд: сократить необходимость присутствия охранника для верификации личности.
- Ускорение прохода сотрудников: уменьшить очереди, особенно в часы пик.
- Повышение безопасности: исключить "человеческий фактор" и ошибки в идентификации.
- Улучшение аналитики: возможность отслеживания перемещений и времени входа/выхода.
### Почему станет лучше, чем сейчас, от использования ML?
- ML-модель (face recognition) обеспечивает более объективную и точную идентификацию, чем визуальная проверка человеком.
- Быстродействие: идентификация за миллисекунды.
- Обучаемость: модель можно дообучать для повышения точности.
- Автоматизация: упрощение интеграции с системами контроля доступа.
### Какие бизнес-требования и ограничения вы видите?
*Требования*:
- Высокая точность идентификации (> 99%).
- Поддержка 5000+ пользователей.
- Обработка фото в реальном времени (не более 1 сек. на проход).
- Интеграция с существующей системой контроля доступа.
- 
*Ограничения*:
- Камеры на КПП могут иметь разное качество.
- Условия освещения различаются.
- Данные сотрудников (фото) могут быть устаревшими.
- Жесткие требования к безопасности и конфиденциальности персональных данных.
### Какие функциональные требования и нефункциональные требования вы видите?
*Функциональные*:
- Захват изображения лица на КПП.
- Сопоставление лица с фото из базы.
- Возврат результата (допустить/заблокировать).
- Интеграция с турникетом/шлагбаумом.
- Журнал событий (логирование).

*Нефункциональные*:
- Время ответа < 1 сек.
- Надежность (доступность 99.9%).
- Масштабируемость до 10 КПП одновременно.
- Безопасность хранения и обработки персональных данных.
- Поддержка обновления данных без остановки сервиса.
### Как бы вы построили процесс пилота? Какие критерии успеха выбрали бы?
*Этапы пилота*:
- Выбор 1 проходной и 500 сотрудников.
- Установка камеры, интеграция с турникетом.
- Сбор эталонных фото сотрудников.
- Настройка модели и системы.
- Тестовый запуск.

*Критерии успеха*:
- ≥ 99% успешных идентификаций.
- ≤ 0.1% False Accept Rate (FAR) — неправильный допуск.
- ≤ 1% False Reject Rate (FRR) — отказ в доступе корректному сотруднику.
- Положительная оценка пользователями (опрос охраны и сотрудников).
- Отсутствие сбоев и стабильная работа в течение 2 недель.
### Что, по вашему мнению, должно входить в итерацию работы на MVP, а что остаться техническим долгом?
*MVP*:
- Модель face recognition.
- API + интерфейс камеры.
- Интеграция с системой контроля доступа.
- База сотрудников с фото.
- Журнал проходов.

*Технический долг*:
- Поддержка масок/перчаток.
- Интеграция с мобильным приложением.
- Распознавание нескольких человек в кадре.
- Расширенная аналитика перемещений.
## Методология
### Что делаем с технической точки зрения: рекомендательная система, поиск аномалий, регрессия, классификация, и др.
Задача относится к компьютерному зрению и биометрии.
*Основные методы*:
- Классификация (сравнение лица с фотографией из базы)
- Сиамские сети
- Детекция и выравнивание лиц
### Какие данные вам нужны? Без чего точно нельзя решить задачу?
- Эталонные фото сотрудников (желательно ≥ 2–3 под разными углами).
- Видео/фото с камер на КПП.
- Метаданные: ID сотрудника, имя, подразделение и др.
- Логи успешных и неуспешных попыток распознавания.
### Какие метрики качества (метрики машинного обучения) используем и как они связаны с бизнес-результатом?
- Precision (точность) – минимизация ложных допусков (чтобы не пропускать чужих).
- Recall (полнота) – минимизация ложных отказов (чтобы не блокировать своих).
- F1-score (баланс между Precision и Recall).
- Время инференса (должно быть <1 сек).
### Какие могут быть риски на этапе анализа и моделирования и что планируем с этим делать?
*Риски*:
- Плохое качество фото → ухудшение точности.
- Освещение/маски/очки → ошибки модели.
- Утечка персональных данных.
- Сопротивление персонала.

*Решения*:
- Улучшение качества камер/освещения.
- Дополнительные фото, аугментация при обучении.
- Хранение данных в зашифрованном виде.
- Пошаговое внедрение и обучение сотрудников.
## Подготовка пилота
### Способ оценки пилота
- % успешных проходов (без ручного вмешательства).
- % ложных отказов (сотрудник не распознан).
- % ложных допусков (чужой прошел).
- Время прохода (сравнение с текущим процессом).
- Обратная связь от сотрудников
### Что считаем успешным пилотом
- Точность: F1-score > 95%.
- Скорость: Среднее время распознавания <1 сек.
- Надежность: Система работает без сбоев 90% времени.
- Удовлетворенность: >90% сотрудников не жалуются на новую систему.
### Подготовка пилота
- Выбор тестовой зоны: 1-2 проходные, 100-200 сотрудников.
- Сбор данных:
    - Фотографии тестовой группы (если нет в базе).
    - Запись видео с камер в разных условиях (утро/вечер, дождь/солнце).
- Развертывание MVP:
  - Детекция лица → извлечение эмбеддингов → сравнение с базой.
  - Интеграция с турникетом (разблокировка при успешном распознавании).
- Мониторинг:
    - Логирование всех событий (успешные/неудачные проходы).
    - Сбор feedback от охраны и сотрудников.
## Внедрение для production системы
### Архитектура решения - как будет выглядеть система - опишите общую архитектуру решения: компоненты, их взаимосвязи, их предназначение.
- Клиентская часть (Edge-устройства):
  - Камеры на проходных (IP-камеры с поддержкой RTSP/ONVIF).
  - Локальные мини-серверы для предобработки видео (детекция лиц, обрезка, отправка на сервер).
- Backend-сервисы (Cloud/On-Premise):
  - API Gateway (Nginx, FastAPI) – прием запросов от камер, балансировка нагрузки.
  - Face Detection & Alignment (MTCNN, RetinaFace) – обнаружение и выравнивание лиц.
  - Face Recognition Model (ArcFace, FaceNet) – преобразование лица в эмбеддинг.
  - Vector Database (Milvus, FAISS) – быстрый поиск по базе сотрудников (~5000 эмбеддингов).
  - Auth Service – принятие решения (свой/чужой), логирование, интеграция с турникетом.
- Базы данных:
    - PostgreSQL – хранение профилей сотрудников (ID, имя, фото, доступы).
    - Redis – кэширование частых запросов (ускорение проверки).
- Мониторинг и логирование:
  - Prometheus + Grafana – метрики (latency, RPS, точность).
### Описание инфраструктуры и масштабируемости: Какая инфраструктура выбрана и почему, плюсы и минусы
| Вариант                                        | Плюсы                                                                     | Минусы |
|----------------------------------------------|---------------------------------------------------------------------------|--------|
| Облако  | Автомасштабирование, готовая ML-инфраструктура                      | Зависимость от интернета, стоимость|
| On-Premise                                        | Полный контроль, низкая задержка|Высокие CAPEX, сложность масштабирования |
### Требования к работе системы: SLA, RPS, Latency...
| Параметр | Требование                                     | Обоснование |
|----------|------------------------------------------------|-------|
| SLA      | 99.9% uptime | Минимизация простоев на проходных|
| RPS      | 	10-20 RPS на проходную          |Пиковая нагрузка |
| Latency  |             <1 сек (end-to-end)                                   |          Чтобы не создавать очереди                              |


### Риски: опишите риски и неопределенности, которые стоит предусмотреть


| Риски                                        | Как минимизировать |
|----------------------------------------------|---|
| Сбои интернета | Локальный кэш  |
| Проблемы с разнообразием (маски, очки, бороды)                                             | Сбор дополнительных данных, использование моделей, устойчивых к атрибутам |
| Рост нагрузки                                          | Автоскейлинг Kubernetes + кэширование запросов  |
|            Юридические ограничения                                            |    	Соответствие 152-ФЗ (хранение биометрии) |
|              Изменение условий освещения                                                                 |                                Дообучение модели на новых данных               |
